<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wedding Guest Book - Buku Tamu Digital</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }
        .font-playfair { font-family: 'Playfair Display', serif; }
        .bg-gradient-wedding {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .bg-gradient-gold {
            background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
        }
        .sidebar-hidden { transform: translateX(-100%); }
        .sidebar-visible { transform: translateX(0); }
        .transition-transform { transition: transform 0.3s ease-in-out; }
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .wedding-bg {
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"><defs><radialGradient id="bg" cx="50%" cy="50%"><stop offset="0%" style="stop-color:%23ffeaa7"/><stop offset="100%" style="stop-color:%23fab1a0"/></radialGradient></defs><rect width="1000" height="1000" fill="url(%23bg)"/><g opacity="0.1"><circle cx="200" cy="200" r="100" fill="%23fff"/><circle cx="800" cy="300" r="80" fill="%23fff"/><circle cx="300" cy="700" r="120" fill="%23fff"/><circle cx="700" cy="800" r="90" fill="%23fff"/></g></svg>');
            background-size: cover;
            background-position: center;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Login Section -->
    <div id="loginSection" class="min-h-screen wedding-bg flex items-center justify-center p-4">
        <div class="glass-effect rounded-2xl p-8 w-full max-w-md">
            <div class="text-center mb-8">
                <h1 class="font-playfair text-4xl font-bold text-white mb-2">Wedding Guest Book</h1>
                <p class="text-white/80">Sistem Buku Tamu Digital</p>
            </div>
            
            <div class="space-y-4">
                <button onclick="showOperatorLogin()" class="w-full bg-white/20 hover:bg-white/30 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-300">
                    Login Operator
                </button>
                <button onclick="showAdminLogin()" class="w-full bg-gradient-gold text-white font-semibold py-3 px-6 rounded-lg hover:shadow-lg transition-all duration-300">
                    Login Admin
                </button>
            </div>
        </div>
    </div>

    <!-- Operator Login Modal -->
    <div id="operatorModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl p-6 w-full max-w-sm">
            <h3 class="font-playfair text-2xl font-bold text-gray-800 mb-4">Login Operator</h3>
            <form onsubmit="loginOperator(event)">
                <div class="mb-4">
                    <label for="operatorName" class="block text-sm font-medium text-gray-700 mb-2">Nama Operator</label>
                    <input type="text" id="operatorName" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>
                <div class="flex space-x-3">
                    <button type="button" onclick="closeModal('operatorModal')" class="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors">
                        Batal
                    </button>
                    <button type="submit" class="flex-1 bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors">
                        Masuk
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="adminModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl p-6 w-full max-w-sm">
            <h3 class="font-playfair text-2xl font-bold text-gray-800 mb-4">Login Admin</h3>
            <form onsubmit="loginAdmin(event)">
                <div class="mb-4">
                    <label for="adminName" class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                    <input type="text" id="adminName" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>
                <div class="mb-4">
                    <label for="adminPassword" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input type="password" id="adminPassword" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>
                <div class="flex space-x-3">
                    <button type="button" onclick="closeModal('adminModal')" class="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors">
                        Batal
                    </button>
                    <button type="submit" class="flex-1 bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors">
                        Masuk
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="hidden min-h-screen bg-gray-50">
        <!-- Sidebar -->
        <div id="sidebar" class="fixed left-0 top-0 h-full w-64 bg-gradient-wedding text-white transition-transform z-40">
            <div class="p-6">
                <h2 class="font-playfair text-2xl font-bold mb-8">Dashboard</h2>
                <nav class="space-y-2">
                    <button onclick="showSection('home')" class="nav-btn w-full text-left px-4 py-3 rounded-lg hover:bg-white/20 transition-colors">
                        🏠 Home
                    </button>
                    <button onclick="showSection('checkin')" class="nav-btn w-full text-left px-4 py-3 rounded-lg hover:bg-white/20 transition-colors">
                        ✅ Check-in
                    </button>
                    <button onclick="showSection('messages')" class="nav-btn w-full text-left px-4 py-3 rounded-lg hover:bg-white/20 transition-colors">
                        💌 Ucapan
                    </button>
                    <button onclick="showSection('analytics')" class="nav-btn w-full text-left px-4 py-3 rounded-lg hover:bg-white/20 transition-colors">
                        📊 Grafik
                    </button>
                    <button onclick="showSection('database')" class="nav-btn w-full text-left px-4 py-3 rounded-lg hover:bg-white/20 transition-colors">
                        🗄️ Database
                    </button>
                    <button onclick="showSection('settings')" class="nav-btn w-full text-left px-4 py-3 rounded-lg hover:bg-white/20 transition-colors" id="settingsBtn">
                        ⚙️ Pengaturan
                    </button>
                    <button onclick="showSection('about')" class="nav-btn w-full text-left px-4 py-3 rounded-lg hover:bg-white/20 transition-colors">
                        ℹ️ About Us
                    </button>
                </nav>
                <button onclick="logout()" class="w-full mt-8 bg-red-500 hover:bg-red-600 px-4 py-3 rounded-lg transition-colors">
                    🚪 Logout
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div id="mainContent" class="ml-64 transition-all duration-300">
            <!-- Header -->
            <header class="bg-white shadow-sm p-4 flex items-center justify-between">
                <button onclick="toggleSidebar()" class="p-2 rounded-lg hover:bg-gray-100">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
                <div class="text-right">
                    <p class="text-sm text-gray-600" id="currentDateTime"></p>
                    <p class="font-semibold" id="currentUser"></p>
                </div>
            </header>

            <!-- Home Section -->
            <section id="homeSection" class="section p-6">
                <div class="wedding-bg rounded-2xl p-8 mb-6 text-center text-white min-h-96 flex flex-col justify-center">
                    <h1 class="font-playfair text-6xl font-bold mb-4" id="brideName">Sarah & Ahmad</h1>
                    <p class="text-xl mb-6">Menikah Insya Allah</p>
                    <p class="text-lg" id="weddingDate">15 Desember 2024</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="bg-white rounded-xl p-6 shadow-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-sm">Total Undangan</p>
                                <p class="text-3xl font-bold text-purple-600" id="totalInvitations">0</p>
                            </div>
                            <div class="bg-purple-100 p-3 rounded-full">
                                <svg class="w-6 h-6 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl p-6 shadow-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-sm">Sudah Check-in</p>
                                <p class="text-3xl font-bold text-green-600" id="totalCheckin">0</p>
                            </div>
                            <div class="bg-green-100 p-3 rounded-full">
                                <svg class="w-6 h-6 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl p-6 shadow-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-sm">Jam</p>
                                <p class="text-2xl font-bold text-blue-600" id="currentTime">00:00</p>
                            </div>
                            <div class="bg-blue-100 p-3 rounded-full">
                                <svg class="w-6 h-6 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl p-6 shadow-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-sm">Ucapan</p>
                                <p class="text-3xl font-bold text-pink-600" id="totalMessages">0</p>
                            </div>
                            <div class="bg-pink-100 p-3 rounded-full">
                                <svg class="w-6 h-6 text-pink-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M18 13V5a2 2 0 00-2-2H4a2 2 0 00-2 2v8a2 2 0 002 2h3l3 3 3-3h3a2 2 0 002-2zM5 7a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1zm1 3a1 1 0 100 2h3a1 1 0 100-2H6z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 bg-white rounded-xl p-6 shadow-lg">
                    <h3 class="text-lg font-semibold mb-4">Grafik Check-in Hari Ini</h3>
                    <canvas id="checkinChart" width="400" height="200"></canvas>
                </div>
            </section>

            <!-- Check-in Section -->
            <section id="checkinSection" class="section hidden p-6">
                <h2 class="text-2xl font-bold mb-6">Check-in Tamu</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <button onclick="showQRScanner()" class="bg-gradient-to-r from-purple-500 to-pink-500 text-white p-6 rounded-xl hover:shadow-lg transition-all">
                        <div class="text-center">
                            <div class="text-4xl mb-2">📱</div>
                            <h3 class="text-lg font-semibold">QR Scanner</h3>
                            <p class="text-sm opacity-90">Scan QR Code tamu</p>
                        </div>
                    </button>
                    
                    <button onclick="showManualQR()" class="bg-gradient-to-r from-blue-500 to-cyan-500 text-white p-6 rounded-xl hover:shadow-lg transition-all">
                        <div class="text-center">
                            <div class="text-4xl mb-2">🔢</div>
                            <h3 class="text-lg font-semibold">QR Manual</h3>
                            <p class="text-sm opacity-90">Input kode QR manual</p>
                        </div>
                    </button>
                    
                    <button onclick="showManualCheckin()" class="bg-gradient-to-r from-green-500 to-teal-500 text-white p-6 rounded-xl hover:shadow-lg transition-all">
                        <div class="text-center">
                            <div class="text-4xl mb-2">✍️</div>
                            <h3 class="text-lg font-semibold">Manual Check-in</h3>
                            <p class="text-sm opacity-90">Input data manual</p>
                        </div>
                    </button>
                </div>
                
                <!-- QR Scanner -->
                <div id="qrScannerDiv" class="hidden bg-white rounded-xl p-6 shadow-lg">
                    <h3 class="text-lg font-semibold mb-4">QR Code Scanner</h3>
                    <div id="qr-reader" class="mb-4"></div>
                    <button onclick="hideQRScanner()" class="bg-gray-500 text-white px-4 py-2 rounded-lg">Tutup Scanner</button>
                </div>
                
                <!-- Manual QR -->
                <div id="manualQRDiv" class="hidden bg-white rounded-xl p-6 shadow-lg">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- QR Code Generator -->
                        <div>
                            <h3 class="text-lg font-semibold mb-4">Generate QR Code untuk Tamu</h3>
                            <form onsubmit="generateQRCode(event)">
                                <div class="mb-4">
                                    <label for="guestNameQR" class="block text-sm font-medium text-gray-700 mb-2">Nama Tamu</label>
                                    <input type="text" id="guestNameQR" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                                </div>
                                <div class="mb-4">
                                    <label for="guestCountQR" class="block text-sm font-medium text-gray-700 mb-2">Jumlah Tamu</label>
                                    <input type="number" id="guestCountQR" min="1" value="1" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                                </div>
                                <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700">
                                    Generate QR Code
                                </button>
                            </form>
                            
                            <!-- Generated QR Code Display -->
                            <div id="qrCodeDisplay" class="hidden mt-6 text-center">
                                <h4 class="font-semibold mb-3">QR Code untuk <span id="qrGuestName"></span></h4>
                                <div id="qrCodeImage" class="bg-white p-4 rounded-lg border-2 border-dashed border-gray-300 inline-block"></div>
                                <p class="text-sm text-gray-600 mt-2">Tamu dapat scan QR code ini untuk check-in mandiri</p>
                                <div class="flex space-x-2 mt-4">
                                    <button onclick="downloadQRCode()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
                                        📥 Download
                                    </button>
                                    <button onclick="printQRCode()" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700">
                                        🖨️ Print
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Manual QR Input -->
                        <div>
                            <h3 class="text-lg font-semibold mb-4">Input QR Code Manual</h3>
                            <form onsubmit="processManualQR(event)">
                                <div class="mb-4">
                                    <label for="qrCode" class="block text-sm font-medium text-gray-700 mb-2">Kode QR</label>
                                    <input type="text" id="qrCode" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" placeholder="Masukkan kode QR...">
                                </div>
                                <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700">
                                    Proses QR Code
                                </button>
                            </form>
                            
                            <!-- Sample QR Codes -->
                            <div class="mt-6">
                                <h4 class="font-semibold mb-3">Contoh QR Code:</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="bg-gray-50 p-2 rounded">
                                        <code>John Doe|2</code>
                                        <button onclick="document.getElementById('qrCode').value='John Doe|2'" class="ml-2 text-blue-600 hover:underline">Gunakan</button>
                                    </div>
                                    <div class="bg-gray-50 p-2 rounded">
                                        <code>Siti Aminah|1</code>
                                        <button onclick="document.getElementById('qrCode').value='Siti Aminah|1'" class="ml-2 text-blue-600 hover:underline">Gunakan</button>
                                    </div>
                                    <div class="bg-gray-50 p-2 rounded">
                                        <code>Keluarga Budi|4</code>
                                        <button onclick="document.getElementById('qrCode').value='Keluarga Budi|4'" class="ml-2 text-blue-600 hover:underline">Gunakan</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6 flex justify-center">
                        <button onclick="hideManualQR()" class="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">
                            Tutup
                        </button>
                    </div>
                </div>
                
                <!-- Manual Check-in -->
                <div id="manualCheckinDiv" class="hidden bg-white rounded-xl p-6 shadow-lg">
                    <h3 class="text-lg font-semibold mb-4">Check-in Manual</h3>
                    <form onsubmit="processManualCheckin(event)">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label for="guestName" class="block text-sm font-medium text-gray-700 mb-2">Nama Tamu</label>
                                <input type="text" id="guestName" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                            </div>
                            <div>
                                <label for="guestCount" class="block text-sm font-medium text-gray-700 mb-2">Jumlah Hadir</label>
                                <input type="number" id="guestCount" min="1" value="1" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                            </div>
                        </div>
                        <div class="mb-4">
                            <label for="guestMessage" class="block text-sm font-medium text-gray-700 mb-2">Ucapan (Opsional)</label>
                            <textarea id="guestMessage" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" placeholder="Ucapan selamat..."></textarea>
                        </div>
                        <div class="flex space-x-3">
                            <button type="button" onclick="hideManualCheckin()" class="bg-gray-500 text-white px-4 py-2 rounded-lg">Batal</button>
                            <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded-lg">Check-in</button>
                        </div>
                    </form>
                </div>
            </section>

            <!-- Messages Section -->
            <section id="messagesSection" class="section hidden p-6">
                <h2 class="text-2xl font-bold mb-6">Ucapan & Doa</h2>
                <div id="messagesList" class="space-y-4">
                    <!-- Messages will be populated here -->
                </div>
            </section>

            <!-- Analytics Section -->
            <section id="analyticsSection" class="section hidden p-6">
                <h2 class="text-2xl font-bold mb-6">Grafik & Analitik</h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white rounded-xl p-6 shadow-lg">
                        <h3 class="text-lg font-semibold mb-4">Check-in per Jam</h3>
                        <canvas id="hourlyChart"></canvas>
                    </div>
                    
                    <div class="bg-white rounded-xl p-6 shadow-lg">
                        <h3 class="text-lg font-semibold mb-4">Status Kehadiran</h3>
                        <canvas id="statusChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Database Section -->
            <section id="databaseSection" class="section hidden p-6">
                <h2 class="text-2xl font-bold mb-6">Database Tamu</h2>
                
                <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                    <div class="p-4 bg-gray-50 border-b">
                        <div class="flex justify-between items-center">
                            <h3 class="text-lg font-semibold">Data Tamu</h3>
                            <button onclick="exportData()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
                                📥 Export CSV
                            </button>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Nama</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Jumlah</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Waktu</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Status</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Ucapan</th>
                                </tr>
                            </thead>
                            <tbody id="guestTableBody">
                                <!-- Data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settingsSection" class="section hidden p-6">
                <h2 class="text-2xl font-bold mb-6">Pengaturan</h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Operator Settings -->
                    <div id="operatorSettings" class="bg-white rounded-xl p-6 shadow-lg">
                        <h3 class="text-lg font-semibold mb-4">Pengaturan Operator</h3>
                        
                        <div class="space-y-4">
                            <div>
                                <label for="eventDateTime" class="block text-sm font-medium text-gray-700 mb-2">Tanggal & Waktu Acara</label>
                                <input type="datetime-local" id="eventDateTime" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                            </div>
                            
                            <div>
                                <label for="musicFile" class="block text-sm font-medium text-gray-700 mb-2">Musik Latar</label>
                                <input type="file" id="musicFile" accept="audio/*" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            </div>
                            
                            <div>
                                <label for="musicVolume" class="block text-sm font-medium text-gray-700 mb-2">Volume Musik</label>
                                <input type="range" id="musicVolume" min="0" max="100" value="50" class="w-full">
                                <span id="volumeValue" class="text-sm text-gray-600">50%</span>
                            </div>
                            
                            <div>
                                <label for="themeSelect" class="block text-sm font-medium text-gray-700 mb-2">Pilihan Tema</label>
                                <select id="themeSelect" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                                    <option value="purple">Purple Gradient</option>
                                    <option value="gold">Gold Gradient</option>
                                    <option value="blue">Blue Ocean</option>
                                    <option value="pink">Pink Romance</option>
                                </select>
                            </div>
                        </div>
                        
                        <button onclick="saveOperatorSettings()" class="w-full mt-6 bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700">
                            Simpan Pengaturan
                        </button>
                    </div>
                    
                    <!-- Admin Settings -->
                    <div id="adminSettings" class="hidden bg-white rounded-xl p-6 shadow-lg">
                        <h3 class="text-lg font-semibold mb-4">Pengaturan Admin</h3>
                        
                        <div class="space-y-4">
                            <div>
                                <label for="newGuestbookUrl" class="block text-sm font-medium text-gray-700 mb-2">Generate URL Buku Tamu Baru</label>
                                <div class="flex space-x-2">
                                    <input type="text" id="newGuestbookUrl" placeholder="nama-acara" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg">
                                    <button onclick="generateNewUrl()" class="bg-blue-600 text-white px-4 py-2 rounded-lg">Generate</button>
                                </div>
                            </div>
                            
                            <div>
                                <label for="backgroundImage" class="block text-sm font-medium text-gray-700 mb-2">Foto Background Home</label>
                                <input type="file" id="backgroundImage" accept="image/*" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label for="brideName1" class="block text-sm font-medium text-gray-700 mb-2">Nama Mempelai 1</label>
                                    <input type="text" id="brideName1" value="Sarah" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                </div>
                                <div>
                                    <label for="brideName2" class="block text-sm font-medium text-gray-700 mb-2">Nama Mempelai 2</label>
                                    <input type="text" id="brideName2" value="Ahmad" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                </div>
                            </div>
                            
                            <div>
                                <label for="newUsername" class="block text-sm font-medium text-gray-700 mb-2">Username Baru</label>
                                <input type="text" id="newUsername" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            </div>
                            
                            <div>
                                <label for="newPassword" class="block text-sm font-medium text-gray-700 mb-2">Password Baru</label>
                                <input type="password" id="newPassword" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            </div>
                        </div>
                        
                        <button onclick="saveAdminSettings()" class="w-full mt-6 bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700">
                            Simpan Pengaturan Admin
                        </button>
                    </div>
                </div>
            </section>

            <!-- About Section -->
            <section id="aboutSection" class="section hidden p-6">
                <h2 class="text-2xl font-bold mb-6">About Us</h2>
                
                <div class="bg-white rounded-xl p-8 shadow-lg text-center">
                    <div class="mb-6">
                        <h3 class="font-playfair text-3xl font-bold text-purple-600 mb-2">Wedding Guest Book Digital</h3>
                        <p class="text-gray-600">Sistem Buku Tamu Digital Modern</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
                        <div class="p-4">
                            <div class="text-2xl mb-2">🌐</div>
                            <h4 class="font-semibold mb-1">Website</h4>
                            <p class="text-sm text-gray-600">weddingbook.digital</p>
                        </div>
                        
                        <div class="p-4">
                            <div class="text-2xl mb-2">📱</div>
                            <h4 class="font-semibold mb-1">WhatsApp</h4>
                            <p class="text-sm text-gray-600">+62 812-3456-7890</p>
                        </div>
                        
                        <div class="p-4">
                            <div class="text-2xl mb-2">📷</div>
                            <h4 class="font-semibold mb-1">Instagram</h4>
                            <p class="text-sm text-gray-600">@weddingbook.digital</p>
                        </div>
                    </div>
                    
                    <div class="mt-8 p-4 bg-purple-50 rounded-lg">
                        <p class="text-sm text-gray-700">
                            Terima kasih telah menggunakan layanan kami. Semoga acara pernikahan Anda berjalan lancar dan penuh berkah.
                        </p>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Message Popup -->
    <div id="messagePopup" class="fixed inset-0 bg-black/50 hidden items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl p-6 w-full max-w-md">
            <div class="text-center mb-4">
                <div class="text-4xl mb-2">💌</div>
                <h3 class="font-playfair text-xl font-bold">Ucapan Baru</h3>
            </div>
            <div id="popupMessageContent" class="text-center">
                <!-- Message content will be inserted here -->
            </div>
            <button onclick="closeMessagePopup()" class="w-full mt-4 bg-purple-600 text-white py-2 px-4 rounded-lg">
                Tutup
            </button>
        </div>
    </div>

    <!-- Audio element for background music -->
    <audio id="backgroundMusic" loop></audio>

    <script>
        // Database simulation using localStorage
        let currentUser = null;
        let userRole = null;
        let guestData = JSON.parse(localStorage.getItem('guestData')) || [];
        let settings = JSON.parse(localStorage.getItem('weddingSettings')) || {
            brideName1: 'Sarah',
            brideName2: 'Ahmad',
            weddingDate: '2024-12-15',
            adminUsername: 'admin',
            adminPassword: 'admin123',
            theme: 'purple',
            musicVolume: 50
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateDateTime();
            setInterval(updateDateTime, 1000);
            loadSettings();
        });

        // Login functions
        function showOperatorLogin() {
            document.getElementById('operatorModal').classList.remove('hidden');
            document.getElementById('operatorModal').classList.add('flex');
        }

        function showAdminLogin() {
            document.getElementById('adminModal').classList.remove('hidden');
            document.getElementById('adminModal').classList.add('flex');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
            document.getElementById(modalId).classList.remove('flex');
        }

        function loginOperator(event) {
            event.preventDefault();
            const name = document.getElementById('operatorName').value;
            if (name.trim()) {
                currentUser = name;
                userRole = 'operator';
                document.getElementById('currentUser').textContent = `Operator: ${name}`;
                showDashboard();
                closeModal('operatorModal');
            }
        }

        function loginAdmin(event) {
            event.preventDefault();
            const username = document.getElementById('adminName').value;
            const password = document.getElementById('adminPassword').value;
            
            if (username === settings.adminUsername && password === settings.adminPassword) {
                currentUser = username;
                userRole = 'admin';
                document.getElementById('currentUser').textContent = `Admin: ${username}`;
                showDashboard();
                closeModal('adminModal');
            } else {
                alert('Username atau password salah!');
            }
        }

        function showDashboard() {
            document.getElementById('loginSection').classList.add('hidden');
            document.getElementById('dashboard').classList.remove('hidden');
            
            // Show/hide settings based on role
            if (userRole === 'admin') {
                document.getElementById('adminSettings').classList.remove('hidden');
            } else {
                document.getElementById('adminSettings').classList.add('hidden');
            }
            
            showSection('home');
            updateStats();
            initCharts();
        }

        function logout() {
            currentUser = null;
            userRole = null;
            document.getElementById('dashboard').classList.add('hidden');
            document.getElementById('loginSection').classList.remove('hidden');
            
            // Reset forms
            document.getElementById('operatorName').value = '';
            document.getElementById('adminName').value = '';
            document.getElementById('adminPassword').value = '';
        }

        // Navigation functions
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            
            if (sidebar.classList.contains('sidebar-hidden')) {
                sidebar.classList.remove('sidebar-hidden');
                sidebar.classList.add('sidebar-visible');
                mainContent.classList.remove('ml-0');
                mainContent.classList.add('ml-64');
            } else {
                sidebar.classList.add('sidebar-hidden');
                sidebar.classList.remove('sidebar-visible');
                mainContent.classList.add('ml-0');
                mainContent.classList.remove('ml-64');
            }
        }

        function showSection(sectionName) {
            // Hide all sections
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.add('hidden'));
            
            // Show selected section
            document.getElementById(sectionName + 'Section').classList.remove('hidden');
            
            // Update nav buttons
            const navButtons = document.querySelectorAll('.nav-btn');
            navButtons.forEach(btn => btn.classList.remove('bg-white/20'));
            event.target.classList.add('bg-white/20');
            
            // Load section-specific data
            if (sectionName === 'messages') {
                loadMessages();
            } else if (sectionName === 'database') {
                loadGuestTable();
            } else if (sectionName === 'analytics') {
                updateAnalytics();
            }
        }

        // Check-in functions
        function showQRScanner() {
            document.getElementById('qrScannerDiv').classList.remove('hidden');
            startQRScanner();
        }

        function hideQRScanner() {
            document.getElementById('qrScannerDiv').classList.add('hidden');
            if (window.html5QrcodeScanner) {
                window.html5QrcodeScanner.clear();
            }
        }

        function startQRScanner() {
            const qrCodeSuccessCallback = (decodedText, decodedResult) => {
                processQRCode(decodedText);
                hideQRScanner();
            };

            const config = { fps: 10, qrbox: { width: 250, height: 250 } };
            window.html5QrcodeScanner = new Html5QrcodeScanner("qr-reader", config, false);
            window.html5QrcodeScanner.render(qrCodeSuccessCallback);
        }

        function showManualQR() {
            document.getElementById('manualQRDiv').classList.remove('hidden');
        }

        function hideManualQR() {
            document.getElementById('manualQRDiv').classList.add('hidden');
            document.getElementById('qrCode').value = '';
            document.getElementById('qrCodeDisplay').classList.add('hidden');
            document.getElementById('guestNameQR').value = '';
            document.getElementById('guestCountQR').value = '1';
        }

        // QR Code Generation Functions
        function generateQRCode(event) {
            event.preventDefault();
            
            const guestName = document.getElementById('guestNameQR').value;
            const guestCount = document.getElementById('guestCountQR').value;
            const qrData = `${guestName}|${guestCount}`;
            
            // Generate QR Code
            const qrCodeContainer = document.getElementById('qrCodeImage');
            qrCodeContainer.innerHTML = ''; // Clear previous QR code
            
            QRCode.toCanvas(qrData, { 
                width: 200, 
                height: 200,
                color: {
                    dark: '#000000',
                    light: '#FFFFFF'
                }
            }, function (error, canvas) {
                if (error) {
                    console.error(error);
                    alert('Error generating QR code');
                    return;
                }
                
                qrCodeContainer.appendChild(canvas);
                document.getElementById('qrGuestName').textContent = guestName;
                document.getElementById('qrCodeDisplay').classList.remove('hidden');
                
                // Store current QR data for download/print
                window.currentQRData = {
                    data: qrData,
                    guestName: guestName,
                    guestCount: guestCount,
                    canvas: canvas
                };
            });
        }

        function downloadQRCode() {
            if (!window.currentQRData) {
                alert('Tidak ada QR code untuk didownload');
                return;
            }
            
            const canvas = window.currentQRData.canvas;
            const link = document.createElement('a');
            link.download = `qr-code-${window.currentQRData.guestName.replace(/\s+/g, '-')}.png`;
            link.href = canvas.toDataURL();
            link.click();
        }

        function printQRCode() {
            if (!window.currentQRData) {
                alert('Tidak ada QR code untuk diprint');
                return;
            }
            
            const printWindow = window.open('', '_blank');
            const canvas = window.currentQRData.canvas;
            const dataURL = canvas.toDataURL();
            
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>QR Code - ${window.currentQRData.guestName}</title>
                    <style>
                        body {
                            font-family: Arial, sans-serif;
                            text-align: center;
                            padding: 20px;
                        }
                        .qr-container {
                            border: 2px solid #000;
                            padding: 20px;
                            display: inline-block;
                            margin: 20px;
                        }
                        .guest-info {
                            margin-top: 15px;
                            font-size: 18px;
                            font-weight: bold;
                        }
                        .instructions {
                            margin-top: 10px;
                            font-size: 14px;
                            color: #666;
                        }
                    </style>
                </head>
                <body>
                    <h1>Wedding Guest Book</h1>
                    <div class="qr-container">
                        <img src="${dataURL}" alt="QR Code" />
                        <div class="guest-info">
                            ${window.currentQRData.guestName}<br>
                            Jumlah Tamu: ${window.currentQRData.guestCount}
                        </div>
                        <div class="instructions">
                            Scan QR code ini untuk check-in mandiri
                        </div>
                    </div>
                </body>
                </html>
            `);
            
            printWindow.document.close();
            printWindow.focus();
            
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 250);
        }

        function processManualQR(event) {
            event.preventDefault();
            const qrCode = document.getElementById('qrCode').value;
            processQRCode(qrCode);
            hideManualQR();
        }

        function processQRCode(qrCode) {
            // Simulate QR code processing
            const guestInfo = parseQRCode(qrCode);
            if (guestInfo) {
                showGuestForm(guestInfo);
            } else {
                alert('QR Code tidak valid!');
            }
        }

        function parseQRCode(qrCode) {
            // Simple QR code format: NAME|COUNT
            const parts = qrCode.split('|');
            if (parts.length >= 2) {
                return {
                    name: parts[0],
                    count: parseInt(parts[1]) || 1
                };
            }
            return null;
        }

        function showGuestForm(guestInfo) {
            const message = prompt(`Check-in untuk: ${guestInfo.name}\nJumlah: ${guestInfo.count}\n\nMasukkan ucapan (opsional):`);
            
            const guest = {
                id: Date.now(),
                name: guestInfo.name,
                count: guestInfo.count,
                datetime: new Date().toISOString(),
                status: 'Hadir',
                message: message || '',
                checkinBy: currentUser
            };
            
            guestData.push(guest);
            localStorage.setItem('guestData', JSON.stringify(guestData));
            
            updateStats();
            
            if (message && message.trim()) {
                showMessagePopup(guest);
            }
            
            alert(`Check-in berhasil untuk ${guestInfo.name}!`);
        }

        function showManualCheckin() {
            document.getElementById('manualCheckinDiv').classList.remove('hidden');
        }

        function hideManualCheckin() {
            document.getElementById('manualCheckinDiv').classList.add('hidden');
            document.getElementById('guestName').value = '';
            document.getElementById('guestCount').value = '1';
            document.getElementById('guestMessage').value = '';
        }

        function processManualCheckin(event) {
            event.preventDefault();
            
            const guest = {
                id: Date.now(),
                name: document.getElementById('guestName').value,
                count: parseInt(document.getElementById('guestCount').value),
                datetime: new Date().toISOString(),
                status: 'Hadir',
                message: document.getElementById('guestMessage').value,
                checkinBy: currentUser
            };
            
            guestData.push(guest);
            localStorage.setItem('guestData', JSON.stringify(guestData));
            
            updateStats();
            hideManualCheckin();
            
            if (guest.message && guest.message.trim()) {
                showMessagePopup(guest);
            }
            
            alert(`Check-in berhasil untuk ${guest.name}!`);
        }

        // Message functions
        function showMessagePopup(guest) {
            const popup = document.getElementById('messagePopup');
            const content = document.getElementById('popupMessageContent');
            
            content.innerHTML = `
                <div class="mb-4">
                    <h4 class="font-semibold text-lg">${guest.name}</h4>
                    <p class="text-sm text-gray-600">${new Date(guest.datetime).toLocaleString('id-ID')}</p>
                </div>
                <div class="bg-purple-50 p-4 rounded-lg">
                    <p class="text-gray-800">${guest.message}</p>
                </div>
            `;
            
            popup.classList.remove('hidden');
            popup.classList.add('flex');
            
            // Auto close after 5 seconds
            setTimeout(() => {
                closeMessagePopup();
            }, 5000);
        }

        function closeMessagePopup() {
            document.getElementById('messagePopup').classList.add('hidden');
            document.getElementById('messagePopup').classList.remove('flex');
        }

        function loadMessages() {
            const messagesList = document.getElementById('messagesList');
            const messagesWithText = guestData.filter(guest => guest.message && guest.message.trim());
            
            if (messagesWithText.length === 0) {
                messagesList.innerHTML = '<p class="text-gray-500 text-center py-8">Belum ada ucapan</p>';
                return;
            }
            
            messagesList.innerHTML = messagesWithText.map(guest => `
                <div class="bg-white rounded-xl p-6 shadow-lg">
                    <div class="flex justify-between items-start mb-3">
                        <h4 class="font-semibold text-lg">${guest.name}</h4>
                        <span class="text-sm text-gray-500">${new Date(guest.datetime).toLocaleString('id-ID')}</span>
                    </div>
                    <p class="text-gray-700 leading-relaxed">${guest.message}</p>
                </div>
            `).join('');
        }

        // Statistics and charts
        function updateStats() {
            const totalInvitations = guestData.length;
            const totalCheckin = guestData.filter(g => g.status === 'Hadir').length;
            const totalMessages = guestData.filter(g => g.message && g.message.trim()).length;
            
            document.getElementById('totalInvitations').textContent = totalInvitations;
            document.getElementById('totalCheckin').textContent = totalCheckin;
            document.getElementById('totalMessages').textContent = totalMessages;
        }

        function updateDateTime() {
            const now = new Date();
            document.getElementById('currentDateTime').textContent = now.toLocaleString('id-ID');
            document.getElementById('currentTime').textContent = now.toLocaleTimeString('id-ID', {
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function initCharts() {
            // Simple chart for check-ins by hour
            const ctx = document.getElementById('checkinChart');
            if (ctx) {
                const hourlyData = getHourlyCheckins();
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: Array.from({length: 24}, (_, i) => `${i}:00`),
                        datasets: [{
                            label: 'Check-ins',
                            data: hourlyData,
                            borderColor: 'rgb(147, 51, 234)',
                            backgroundColor: 'rgba(147, 51, 234, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
        }

        function getHourlyCheckins() {
            const hourlyCount = new Array(24).fill(0);
            const today = new Date().toDateString();
            
            guestData.forEach(guest => {
                const guestDate = new Date(guest.datetime);
                if (guestDate.toDateString() === today) {
                    hourlyCount[guestDate.getHours()]++;
                }
            });
            
            return hourlyCount;
        }

        function updateAnalytics() {
            // Update hourly chart
            const hourlyCtx = document.getElementById('hourlyChart');
            if (hourlyCtx) {
                const hourlyData = getHourlyCheckins();
                new Chart(hourlyCtx, {
                    type: 'bar',
                    data: {
                        labels: Array.from({length: 24}, (_, i) => `${i}:00`),
                        datasets: [{
                            label: 'Check-ins per Jam',
                            data: hourlyData,
                            backgroundColor: 'rgba(147, 51, 234, 0.8)'
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
            
            // Update status chart
            const statusCtx = document.getElementById('statusChart');
            if (statusCtx) {
                const hadir = guestData.filter(g => g.status === 'Hadir').length;
                const belumHadir = guestData.length - hadir;
                
                new Chart(statusCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Hadir', 'Belum Hadir'],
                        datasets: [{
                            data: [hadir, belumHadir],
                            backgroundColor: ['#10B981', '#EF4444']
                        }]
                    },
                    options: {
                        responsive: true
                    }
                });
            }
        }

        // Database functions
        function loadGuestTable() {
            const tbody = document.getElementById('guestTableBody');
            
            if (guestData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="px-4 py-8 text-center text-gray-500">Belum ada data tamu</td></tr>';
                return;
            }
            
            tbody.innerHTML = guestData.map(guest => `
                <tr class="border-b hover:bg-gray-50">
                    <td class="px-4 py-3">${guest.name}</td>
                    <td class="px-4 py-3">${guest.count}</td>
                    <td class="px-4 py-3">${new Date(guest.datetime).toLocaleString('id-ID')}</td>
                    <td class="px-4 py-3">
                        <span class="px-2 py-1 text-xs rounded-full ${guest.status === 'Hadir' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                            ${guest.status}
                        </span>
                    </td>
                    <td class="px-4 py-3 max-w-xs truncate">${guest.message || '-'}</td>
                </tr>
            `).join('');
        }

        function exportData() {
            if (guestData.length === 0) {
                alert('Tidak ada data untuk diekspor');
                return;
            }
            
            const csv = [
                ['Nama', 'Jumlah', 'Tanggal', 'Waktu', 'Status', 'Ucapan'],
                ...guestData.map(guest => {
                    const date = new Date(guest.datetime);
                    return [
                        guest.name,
                        guest.count,
                        date.toLocaleDateString('id-ID'),
                        date.toLocaleTimeString('id-ID'),
                        guest.status,
                        guest.message || ''
                    ];
                })
            ].map(row => row.map(cell => `"${cell}"`).join(',')).join('\n');
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `guest-data-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Settings functions
        function loadSettings() {
            document.getElementById('brideName').textContent = `${settings.brideName1} & ${settings.brideName2}`;
            document.getElementById('brideName1').value = settings.brideName1;
            document.getElementById('brideName2').value = settings.brideName2;
            document.getElementById('musicVolume').value = settings.musicVolume;
            document.getElementById('volumeValue').textContent = settings.musicVolume + '%';
            document.getElementById('themeSelect').value = settings.theme;
            
            // Apply theme
            applyTheme(settings.theme);
        }

        function saveOperatorSettings() {
            const eventDateTime = document.getElementById('eventDateTime').value;
            const musicFile = document.getElementById('musicFile').files[0];
            const musicVolume = document.getElementById('musicVolume').value;
            const theme = document.getElementById('themeSelect').value;
            
            settings.musicVolume = parseInt(musicVolume);
            settings.theme = theme;
            
            if (eventDateTime) {
                settings.weddingDate = eventDateTime;
                document.getElementById('weddingDate').textContent = new Date(eventDateTime).toLocaleDateString('id-ID');
            }
            
            if (musicFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const audio = document.getElementById('backgroundMusic');
                    audio.src = e.target.result;
                    audio.volume = settings.musicVolume / 100;
                    audio.play();
                };
                reader.readAsDataURL(musicFile);
            }
            
            applyTheme(theme);
            localStorage.setItem('weddingSettings', JSON.stringify(settings));
            alert('Pengaturan operator berhasil disimpan!');
        }

        function saveAdminSettings() {
            const newUrl = document.getElementById('newGuestbookUrl').value;
            const backgroundImage = document.getElementById('backgroundImage').files[0];
            const brideName1 = document.getElementById('brideName1').value;
            const brideName2 = document.getElementById('brideName2').value;
            const newUsername = document.getElementById('newUsername').value;
            const newPassword = document.getElementById('newPassword').value;
            
            if (brideName1 && brideName2) {
                settings.brideName1 = brideName1;
                settings.brideName2 = brideName2;
                document.getElementById('brideName').textContent = `${brideName1} & ${brideName2}`;
            }
            
            if (newUsername && newPassword) {
                settings.adminUsername = newUsername;
                settings.adminPassword = newPassword;
            }
            
            if (backgroundImage) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    // Update background image
                    const homeSection = document.querySelector('#homeSection .wedding-bg');
                    homeSection.style.backgroundImage = `url(${e.target.result})`;
                };
                reader.readAsDataURL(backgroundImage);
            }
            
            localStorage.setItem('weddingSettings', JSON.stringify(settings));
            alert('Pengaturan admin berhasil disimpan!');
        }

        function generateNewUrl() {
            const urlName = document.getElementById('newGuestbookUrl').value;
            if (urlName) {
                const newUrl = `${window.location.origin}/guestbook/${urlName}`;
                alert(`URL baru berhasil dibuat:\n${newUrl}`);
            }
        }

        function applyTheme(theme) {
            const sidebar = document.getElementById('sidebar');
            const themes = {
                purple: 'bg-gradient-wedding',
                gold: 'bg-gradient-gold',
                blue: 'bg-gradient-to-br from-blue-600 to-blue-800',
                pink: 'bg-gradient-to-br from-pink-500 to-rose-600'
            };
            
            // Remove all theme classes
            Object.values(themes).forEach(themeClass => {
                sidebar.classList.remove(...themeClass.split(' '));
            });
            
            // Add selected theme
            sidebar.classList.add(...themes[theme].split(' '));
        }

        // Volume control
        document.getElementById('musicVolume').addEventListener('input', function() {
            const volume = this.value;
            document.getElementById('volumeValue').textContent = volume + '%';
            const audio = document.getElementById('backgroundMusic');
            audio.volume = volume / 100;
        });

        // Sample data for testing
        function addSampleData() {
            const sampleGuests = [
                { name: 'Budi Santoso', count: 2, message: 'Selamat menempuh hidup baru! Semoga bahagia selalu.' },
                { name: 'Siti Nurhaliza', count: 1, message: 'Barakallahu lakuma wa baraka alaikuma!' },
                { name: 'Ahmad Fauzi', count: 3, message: 'Semoga menjadi keluarga yang sakinah mawaddah warahmah.' },
                { name: 'Dewi Sartika', count: 2, message: 'Selamat ya! Semoga langgeng sampai kakek nenek.' },
                { name: 'Rudi Hermawan', count: 1, message: 'Congratulations! Wishing you both endless love and happiness.' }
            ];
            
            sampleGuests.forEach((guest, index) => {
                const guestData = {
                    id: Date.now() + index,
                    name: guest.name,
                    count: guest.count,
                    datetime: new Date(Date.now() - Math.random() * 86400000).toISOString(),
                    status: 'Hadir',
                    message: guest.message,
                    checkinBy: 'System'
                };
                
                guestData.push(guestData);
            });
            
            localStorage.setItem('guestData', JSON.stringify(guestData));
        }

        // Add sample data on first load
        if (guestData.length === 0) {
            addSampleData();
            guestData = JSON.parse(localStorage.getItem('guestData')) || [];
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98f6e2fd61b089d3',t:'MTc2MDYxMDY4Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
